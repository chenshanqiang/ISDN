<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>音视频一线通终端管理设置</title>
        <meta http-equiv="content-type" content="text/html;charset=utf-8" />
        <meta name="renderer" content="webkit" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <link rel="stylesheet" href="./css/main.css">
        <style type="text/css">
            .layui-form-mid {
                margin-left: 10%;
            }
            .button {
                margin-left: 14%;
            }
        </style>
    </head>
    <body>
        <div class="x-nav">
            <span class="layui-breadcrumb" lay-separator=">">
                <a>
                    <cite>首页</cite>
                </a>
                <a>
                    <cite>管理员</cite>
                </a>
                <a>
                    <cite>导播命令配置</cite>
                </a>
            </span>
            <a class="layui-btn layui-btn-sm" style="float: right;" onclick="freThisPaper()" href="javascript:void(0);" title="刷新">
                <i class="layui-icon layui-icon-refresh"></i>
            </a>
        </div>
        <form class="layui-form layui-form-pane" lay-filter="form_apply_fir">
            <fieldset class="layui-elem-field layui-field-box">
                <legend>录播摄像头配置</legend>
                <div class="layui-form-item">
                    <label class="layui-form-label">IP</label>
                    <div class="layui-input-block">
                        <input type="text" id="ip" lay-verify="ip" name="ip" autocomplete="off" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">端口</label>
                    <div class="layui-input-block">
                        <input type="text" id="port" lay-verify="port" name="port" autocomplete="off" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button class="layui-btn layui-btn-primary" lay-submit="" lay-filter="demo1">提交</button>
                    </div>
                </div>
            </fieldset>
        </form>
        <form class="layui-form layui-form-pane" lay-filter="form_apply_sec">
            <fieldset class="layui-elem-field layui-field-box layui-form-auto">
                <legend>教师摄像头</legend>
                <div class="layui-form-item">
                    <label class="layui-form-label">锁定目标</label>
                    <div class="layui-input-block">
                        <input type="text" id="tc_od1" lay-verify="order" name="techOne" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">目标丢失</label>
                    <div class="layui-input-block">
                        <input type="text" id="tc_od2" lay-verify="order" name="techTwo" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">走下讲台</label>
                    <div class="layui-input-block">
                        <input type="text" id="tc_od3" lay-verify="order" name="techThree" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">走上讲台</label>
                    <div class="layui-input-block">
                        <input type="text" id="tc_od4" lay-verify="order" name="techFour" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">老师运动</label>
                    <div class="layui-input-block">
                        <input type="text" id="tc_od5" lay-verify="order" name="techFive" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">老师停止</label>
                    <div class="layui-input-block">
                        <input type="text" id="tc_od6" lay-verify="order" name="techSix" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button class="layui-btn layui-btn-primary" lay-submit="" lay-filter="demo2">提交</button>
                    </div>
                </div>
            </fieldset>
        </form>
        <form class="layui-form layui-form-pane" lay-filter="form_apply_third">
            <fieldset class="layui-elem-field layui-field-box layui-form-auto">
                <legend>学生摄像头</legend>
                <div class="layui-form-item">
                    <label class="layui-form-label">学生起立</label>
                    <div class="layui-input-block">
                        <input type="text" id="sd_od1" lay-verify="order" name="stuOne" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">学生坐下</label>
                    <div class="layui-input-block">
                        <input type="text" id="sd_od2" lay-verify="order" name="stuTwo" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">特写就位</label>
                    <div class="layui-input-block">
                        <input type="text" id="sd_od3" lay-verify="order" name="stuThree" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">多目标</label>
                    <div class="layui-input-block">
                        <input type="text" id="sd_od4" lay-verify="order" name="stuFour" autocomplete="off" placeholder="" class="layui-input"> </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button class="layui-btn layui-btn-primary" lay-submit="" lay-filter="demo3">提交</button>
                    </div>
                </div>
            </fieldset>
            <div class="layui-form-mid layui-word-aux" style="">注：请输入十六进制数与英文逗号的组合，十六进制数必须是俩位,如：“01,01,01,aa,02,”。</div>
        </form>
        <script type="text/javascript" src='./js/protocal.js'></script>
        <script type="text/javascript" src="./js/security.js"></script>
        <script type="text/javascript" src="./js/forbid_backspace.js"></script>
        <script type="text/javascript" src="./layui/layui.js"></script>
        <script type="text/javascript" src="./js/parse.js"></script>
        <script type="text/javascript">
            layui.use(['element', 'form', 'layer', 'jquery'], function () {
                var layer = layui.layer,
                    form = layui.form,
                    $ = layui.jquery;
                var resultzero = protocal_get("networkcmd", null);
                var resultone = protocal_get('studentcmd', null);
                var resulttwo = protocal_get("teachercmd", null);
                /*var resultzero = ['172.16.15.23', '1'];
                var resulttwo = ['11,', '11,', '11,', '11,', '11,', '11,'];
                var resultone = ['12,', '12,', '12,', '12,'];*/
                form.val('form_apply_fir', {
                    "ip": resultzero[0],
                    "port": resultzero[1]
                })
                form.val('form_apply_sec', {
                    "techOne": resulttwo[0],
                    "techTwo": resulttwo[1],
                    "techThree": resulttwo[2],
                    "techFour": resulttwo[3],
                    "techFive": resulttwo[4],
                    "techSix": resulttwo[5]
                })
                form.val('form_apply_third', {
                    "stuOne": resultone[0],
                    "stuTwo": resultone[1],
                    "stuThree": resultone[2],
                    "stuFour": resultone[3]
                })
                //监听提交
                form.on('submit(demo1)', function (data) {
                    try {
                        var value = data.field.ip + '&' + data.field.port;
                        var result = protocal_set('networkcmd', value);
                        if(result[0] == 'ok') {
                            top.layer.open({
                                title: false,
                                icon: 6,
                                time: 250000,
                                content: '正在重启系统...',
                                btn: false,
                                skin: "layui-layer-molv",
                                closeBtn: 0,
                            })
                            setCookie("username", "", "pass", "", "usernameone", "", "passone", "");
                            setTimeout(function () {
                                window.parent.location.reload();
                            }, 25000);
                        } else {
                            layer.msg('提交失败！', {
                                time: 3000,
                                icon: 2,
                                anim: 0,
                                skin: 'message',
                                shade: [0.5, '#393D49']
                            });
                        }
                    } catch(err) {
                        alert(err);
                    }
                    return false;
                });
                form.on('submit(demo2)', function (data) {
                    try {
                        var value = data.field.techOne + '&' + data.field.techTwo + '&' + data.field.techThree + '&' + data.field.techFour + '&' + data.field.techFive + '&' + data.field.techSix;
                        var result = protocal_set('teachercmd', value);
                        if(result[0] == 'ok') {
                            layer.msg('提交成功！', {
                                time: 3000,
                                icon: 1,
                                anim: 0,
                                skin: 'message',
                                shade: [0.5, '#393D49']
                            });
                        } else {
                            layer.msg('提交失败！', {
                                time: 3000,
                                icon: 2,
                                anim: 0,
                                skin: 'message',
                                shade: [0.5, '#393D49']
                            });
                        }
                    } catch(err) {
                        alert(err);
                    }
                    return false;
                })
                form.on('submit(demo3)', function (data) {
                    try {
                        var value = data.field.stuOne + '&' + data.field.stuTwo + '&' + data.field.stuThree + '&' + data.field.stuFour;
                        var result = protocal_set('studentcmd', value);
                        if(result[0] == 'ok') {
                            layer.msg('提交成功！', {
                                time: 3000,
                                icon: 1,
                                anim: 0,
                                skin: 'message',
                                shade: [0.5, '#393D49']
                            });
                        } else {
                            layer.msg('提交失败！', {
                                time: 3000,
                                icon: 2,
                                anim: 0,
                                skin: 'message',
                                shade: [0.5, '#393D49']
                            });
                        }
                    } catch(err) {
                        alert(err);
                    }
                    return false;
                })
                form.verify({
                    ip: function (value) {
                        var reg = /^(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])$/;
                        if(!value) {
                            return '输入不能为空！';
                        }
                        if(!reg.test(value)) {
                            return '输入IP错误！';
                        }
                    },
                    port: function (value) {
                        var reg = /^\d{0,}$/;
                        if(!value) {
                            return '输入不能为空！';
                        }
                        if(value < 1 || value > 65535 || !reg.test(value)) {
                            return '端口的输入范围设置为：1-65535，请重新输入！';
                        }
                    },
                    order: function (value) {
                        var reg = /^([0-9a-fA-F][0-9a-fA-F][,]){0,}$/;
                        if(!value) {
                            return '输入不能为空！';
                        }
                        if(!reg.test(value)) {
                            return '输入的格式或范围有误！';
                        }
                    }
                })
            })
        </script>
    </body>
</html>